---
import Layout from '@/layouts/Layout.astro'

import PersonProfileCard from '@/components/People/PersonProfileCard.astro'
import PersonSocialLink from '@/components/People/PersonSocialLink.astro'

import { PEOPLE } from '@/constants/people'

const { id } = Astro.params
if (!id) return Astro.redirect('/404')

const person = PEOPLE.find((person) => person.id === id)
if (!person) return Astro.redirect('/404')

const description = `Biografía y datos de ${person.name}. ${person.bio.substring(0, 120)}${person.bio.length > 120 ? '...' : ''}`
const canonical = `https://www.thirtys-album.vlorente.dev/person/${id}`

const birthDate = person.birthDate.toLocaleDateString('es-ES', {
	year: 'numeric',
	month: 'short',
	day: 'numeric',
})

export const prerender = true

export const getStaticPaths = () => {
	return PEOPLE.map((person) => ({
		params: { id: person.id },
	}))
}
---

<Layout title={`${person.name}`} description={description} canonical={canonical}>
	<section class="relative flex w-full flex-col-reverse lg:min-h-screen lg:flex-row">
		<!-- Boxeador perfil -->
		<div
			class="relative z-10 flex w-full flex-col items-center justify-center pl-0 pr-0 lg:flex-row lg:items-start lg:pr-8"
		>
			<!-- Imagenes del boxeador -->
			<div
				class="lg:min-w-sm relative mt-8 flex h-[60vh] w-full items-center justify-center px-6 pt-24 lg:mt-0 lg:h-[80vh] lg:w-1/2 lg:px-2 lg:pt-32"
			>
				<img
					src={`/images/people/big/${id}.webp`}
					alt={`Retrato de ${person.name}`}
					class="mask-fade-bottom h-auto w-[400px] object-contain transition-transform duration-700 hover:scale-105"
					transition:name={`image-${id}`}
				/>
				<img
					src={`/images/people/text/${id}.webp`}
					alt={`Nombre de ${person.name} en texto decorativo`}
					class="lg:bottom-34 absolute bottom-6 h-10 w-auto lg:h-16"
					transition:name={`text-${id}`}
				/>
			</div>
			<!-- Fin de las imagenes del boxeador -->

			<!-- Tarjeta del boxeador -->
			<div
				class="flex w-full max-w-xl flex-col items-center justify-center space-y-4 px-8 text-white lg:min-h-screen lg:w-1/2 lg:px-0"
			>
				<PersonProfileCard person={person} birthDate={birthDate} />
			</div>
			<!-- Fin de la tarjeta del boxeador -->
		</div>
	</section>

	{
		person.bio && (
			<section class="relative z-10 mx-auto mb-16 mt-10 max-w-6xl px-4 font-sans font-semibold lg:-mt-48 lg:px-10">
				<div class="flex flex-col gap-8 lg:flex-row lg:gap-16">
					{/* Columna izquierda: Biografía */}
					<div class="gap-y flex flex-col justify-center gap-y-16 lg:w-1/2">
						<p class="text-dark-magenta mx-auto w-full max-w-xl whitespace-pre-line text-pretty px-4 text-sm [text-transform:none] md:px-0 md:text-base lg:text-left lg:text-lg">
							{person.bio}
						</p>

						<div class="flex flex-wrap justify-center gap-2 space-x-2 px-4 lg:px-0">
							{(person.socials || [])?.map((item) => (
								<PersonSocialLink social={item} />
							))}
						</div>
					</div>
				</div>
			</section>
		)
	}

	<!-- Fin de video de entrenamientos -->
</Layout>

<style>
	.stat-item {
		animation: fadeIn 0.5s ease-out forwards;
		opacity: 0;
	}

	.stat-item:nth-child(1) {
		animation-delay: 0.1s;
	}
	.stat-item:nth-child(2) {
		animation-delay: 0.2s;
	}
	.stat-item:nth-child(3) {
		animation-delay: 0.3s;
	}
	.stat-item:nth-child(4) {
		animation-delay: 0.4s;
	}

	.mask-image-fade-bottom {
		mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
		-webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
	}

	@keyframes fadeIn {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
</style>
